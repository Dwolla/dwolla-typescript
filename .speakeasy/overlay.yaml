overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Typescript SDK Overlay
  version: 0.0.0
actions:
  # Override Speakeasy server-id for each server
  - target: $.servers[0]
    update:
      x-speakeasy-server-id: prod
  - target: $.servers[1]
    update:
      x-speakeasy-server-id: sandbox

  # Remove the original customer creation POST endpoint. Customer creation has been moved to path fragments.
  - target: $["paths"]["/customers"]["post"]
    remove: true

  # Add path fragments for separate customer creation methods
  - target: $["paths"]
    update:
      "/customers#unverified":
        post:
          x-speakeasy-name-override: createUnverified
          tags:
            - customers
          summary: Create an unverified customer
          description: Creates a new unverified customer with basic information. Unverified customers have limited transaction capabilities.
          operationId: createUnverifiedCustomer
          parameters: []
          requestBody:
            required: true
            description: Parameters for unverified customer to be created
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  $ref: '#/components/schemas/CreateUnverifiedCustomer'
          responses:
            '201':
              description: successful operation
              headers:
                Location:
                  description: URL of the created customer resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/customers/12345678-1234-1234-1234-123456789012"
            '400':
              description: Bad Request
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BadRequest
                      message:
                        type: string
                        example: The request body contains bad syntax or is incomplete.
            '403':
              description: forbidden
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: forbidden
                      message:
                        type: string
                        example: Not authorized to create customers.
      "/customers#receive-only":
        post:
          x-speakeasy-name-override: createReceiveOnly
          tags:
            - customers
          summary: Create a receive-only user
          description: Creates a new receive-only user who can only receive funds, not send them.
          operationId: createReceiveOnlyCustomer
          parameters: []
          requestBody:
            required: true
            description: Parameters for receive-only user to be created
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  $ref: '#/components/schemas/CreateReceiveOnlyUser'
          responses:
            '201':
              description: successful operation
              headers:
                Location:
                  description: URL of the created customer resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/customers/12345678-1234-1234-1234-123456789012"
            '400':
              description: Bad Request
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BadRequest
                      message:
                        type: string
                        example: The request body contains bad syntax or is incomplete.
            '403':
              description: forbidden
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: forbidden
                      message:
                        type: string
                        example: Not authorized to create customers.
      "/customers#verified-personal":
        post:
          x-speakeasy-name-override: createVerifiedPersonal
          tags:
            - customers
          summary: Create a verified personal customer
          description: Creates a new verified personal customer with full transaction capabilities.
          operationId: createVerifiedPersonalCustomer
          parameters: []
          requestBody:
            required: true
            description: Parameters for verified personal customer to be created
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  $ref: '#/components/schemas/CreateVerifiedPersonalCustomer'
          responses:
            '201':
              description: successful operation
              headers:
                Location:
                  description: URL of the created customer resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/customers/12345678-1234-1234-1234-123456789012"
            '400':
              description: Bad Request
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BadRequest
                      message:
                        type: string
                        example: The request body contains bad syntax or is incomplete.
            '403':
              description: forbidden
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: forbidden
                      message:
                        type: string
                        example: Not authorized to create customers.
      "/customers#verified-sole-prop":
        post:
          x-speakeasy-name-override: createVerifiedSoleProp
          tags:
            - customers
          summary: Create a verified sole proprietorship customer
          description: Creates a new verified sole proprietorship business customer.
          operationId: createVerifiedSolePropCustomer
          parameters: []
          requestBody:
            required: true
            description: Parameters for verified sole proprietorship customer to be created
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  $ref: '#/components/schemas/CreateVerifiedSolePropCustomer'
          responses:
            '201':
              description: successful operation
              headers:
                Location:
                  description: URL of the created customer resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/customers/12345678-1234-1234-1234-123456789012"
            '400':
              description: Bad Request
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BadRequest
                      message:
                        type: string
                        example: The request body contains bad syntax or is incomplete.
            '403':
              description: forbidden
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: forbidden
                      message:
                        type: string
                        example: Not authorized to create customers.
      "/customers#verified-business":
        post:
          x-speakeasy-name-override: createVerifiedBusiness
          tags:
            - customers
          summary: Create a verified business customer
          description: Creates a new verified business customer with a US controller.
          operationId: createVerifiedBusinessCustomer
          parameters: []
          requestBody:
            required: true
            description: Parameters for verified business customer to be created
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  $ref: '#/components/schemas/CreateVerifiedBusinessCustomerWithController'
          responses:
            '201':
              description: successful operation
              headers:
                Location:
                  description: URL of the created customer resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/customers/12345678-1234-1234-1234-123456789012"
            '400':
              description: Bad Request
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BadRequest
                      message:
                        type: string
                        example: The request body contains bad syntax or is incomplete.
            '403':
              description: forbidden
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: forbidden
                      message:
                        type: string
                        example: Not authorized to create customers.
      "/customers#verified-business-international":
        post:
          x-speakeasy-name-override: createVerifiedBusinessInternational
          tags:
            - customers
          summary: Create a verified business customer with international controller
          description: Creates a new verified business customer with an international (non-US) controller.
          operationId: createVerifiedBusinessInternationalCustomer
          parameters: []
          requestBody:
            required: true
            description: Parameters for verified business customer with international controller to be created
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  $ref: '#/components/schemas/CreateVerifiedBusinessCustomerWithInternationalController'
          responses:
            '201':
              description: successful operation
              headers:
                Location:
                  description: URL of the created customer resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/customers/12345678-1234-1234-1234-123456789012"
            '400':
              description: Bad Request
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: BadRequest
                      message:
                        type: string
                        example: The request body contains bad syntax or is incomplete.
            '403':
              description: forbidden
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: forbidden
                      message:
                        type: string
                        example: Not authorized to create customers.

  # Define separate schemas for each customer type
  - target: $["components"]["schemas"]
    update:
      CreateUnverifiedCustomer:
        title: CreateUnverifiedCustomer
        description: Create an Unverified Customer
        type: object
        required:
          - firstName
          - lastName
          - email
        properties:
          firstName:
            type: string
            example: Account
          lastName:
            type: string
            example: Admin
          email:
            type: string
            example: accountAdmin@email.com
          ipAddress:
            type: string
            example: 143.156.7.8
          phone:
            type: string
            example: 5555555555
          correlationId:
            type: string
            example: fc451a7a-ae30-4404-aB95-e3553fcd733
          businessName:
            type: string
            example: Jane Corp llc
      CreateReceiveOnlyUser:
        title: CreateReceiveOnlyUser
        description: Create a Receive Only User
        type: object
        required:
          - firstName
          - lastName
          - email
          - type
        properties:
          firstName:
            type: string
            example: Account
          lastName:
            type: string
            example: Admin
          email:
            type: string
            example: accountAdmin@email.com
          type:
            type: string
            const: receive-only
          ipAddress:
            type: string
            example: 143.156.7.8
          phone:
            type: string
            example: 5555555555
          correlationId:
            type: string
            example: fc451a7a-ae30-4404-aB95-e3553fcd733
          businessName:
            type: string
            example: Jane Corp llc
      CreateVerifiedPersonalCustomer:
        title: CreateVerifiedPersonalCustomer
        description: Create a Verified Personal customer
        type: object
        required:
          - firstName
          - lastName
          - email
          - address1
          - city
          - state
          - postalCode
          - dateOfBirth
          - type
          - ssn
        properties:
          firstName:
            type: string
            example: Account
          lastName:
            type: string
            example: Admin
          email:
            type: string
            example: accountAdmin@email.com
          type:
            type: string
            const: personal
          ipAddress:
            type: string
            example: 143.156.7.8
          phone:
            type: string
            example: 5555555555
          correlationId:
            type: string
            example: fc451a7a-ae30-4404-aB95-e3553fcd733
          address1:
            type: string
            example: 99-99 33rd St
          address2:
            type: string
            example: 99-99 33rd St
          city:
            type: string
            example: Some City
          state:
            type: string
            example: NY
          postalCode:
            type: string
            example: 11101
          ssn:
            type: string
            example: 1234
          dateOfBirth:
            type: string
            example: 1980-09-12
      CreateVerifiedSolePropCustomer:
        title: CreateVerifiedSolePropCustomer
        description: Create a Verified Business customer (Sole Proprietorship)
        type: object
        required:
          - firstName
          - lastName
          - email
          - address1
          - city
          - state
          - postalCode
          - dateOfBirth
          - type
          - ssn
          - businessType
          - businessName
          - businessClassification
        properties:
          firstName:
            type: string
            example: John
          lastName:
            type: string
            example: Doe
          email:
            type: string
            example: johndoe@email.com
          type:
            type: string
            const: business
          businessType:
            type: string
            const: soleProprietorship
          ipAddress:
            type: string
            example: 143.156.7.8
          phone:
            type: string
            example: 5555555555
          correlationId:
            type: string
            example: fc451a7a-ae30-4404-aB95-e3553fcd733
          address1:
            type: string
            example: 99-99 33rd St
          address2:
            type: string
            example: 99-99 33rd St
          city:
            type: string
            example: Some City
          state:
            type: string
            example: NY
          postalCode:
            type: string
            example: 11101
          ssn:
            type: string
            example: 1234
          dateOfBirth:
            type: string
            example: 1980-09-12
          businessClassification:
            type: string
            example: 9ed3f670-7d6f-11e3-b1ce-5404a6144203
          businessName:
            type: string
            example: Jane Corp
          doingBusinessAs:
            type: string
            example: Jane's Electronics
          ein:
            type: string
            example: 00-0000000
          website:
            type: string
            example: https://www.domain.com
      CreateVerifiedBusinessCustomerWithController:
        title: CreateVerifiedBusinessCustomerWithController
        description: Create a Verified Business customer with a US controller
        type: object
        required:
          - firstName
          - lastName
          - email
          - address1
          - city
          - state
          - postalCode
          - type
          - businessType
          - controller
          - businessName
          - businessClassification
          - ein
        properties:
          firstName:
            type: string
            example: Jane
          lastName:
            type: string
            example: Business
          email:
            type: string
            example: jane.business@email.com
          type:
            type: string
            const: business
          ipAddress:
            type: string
            example: 143.156.7.8
          phone:
            type: string
            example: 5555555555
          correlationId:
            type: string
            example: fc451a7a-ae30-4404-aB95-e3553fcd733
          address1:
            type: string
            example: 99-99 33rd St
          address2:
            type: string
            example: 99-99 33rd St
          city:
            type: string
            example: Some City
          state:
            type: string
            example: NY
          postalCode:
            type: string
            example: 11101
          businessClassification:
            type: string
            example: 9ed3f670-7d6f-11e3-b1ce-5404a6144203
          businessName:
            type: string
            example: Jane Corp
          doingBusinessAs:
            type: string
            example: Jane's Electronics
          ein:
            type: string
            example: 00-0000000
          website:
            type: string
            example: https://www.domain.com
          controller:
            type: object
            required:
              - firstName
              - lastName
              - title
              - dateOfBirth
              - address
              - ssn
            properties:
              firstName:
                type: string
                example: John
              lastName:
                type: string
                example: Controller
              title:
                type: string
                example: CEO
              dateOfBirth:
                type: string
                example: 1980-01-31
              address:
                type: object
                properties:
                  address1:
                    type: string
                  address2:
                    type: string
                  city:
                    type: string
                  stateProvinceRegion:
                    type: string
                  country:
                    type: string
                  postalCode:
                    type: string
              ssn:
                type: string
                example: '1234'
          businessType:
            type: string
            enum: [llc, corporation, partnership]
            example: llc
      CreateVerifiedBusinessCustomerWithInternationalController:
        title: CreateVerifiedBusinessCustomerWithInternationalController
        description: Create a Verified Business customer with an international (non US) controller 
        type: object
        required:
          - firstName
          - lastName
          - email
          - address1
          - city
          - state
          - postalCode
          - type
          - businessType
          - controller
          - businessName
          - businessClassification
          - ein
        properties:
          firstName:
            type: string
            example: Jane
          lastName:
            type: string
            example: Business
          email:
            type: string
            example: jane.business@email.com
          type:
            type: string
            const: business
          ipAddress:
            type: string
            example: 143.156.7.8
          phone:
            type: string
            example: 5555555555
          correlationId:
            type: string
            example: fc451a7a-ae30-4404-aB95-e3553fcd733
          address1:
            type: string
            example: 99-99 33rd St
          address2:
            type: string
            example: 99-99 33rd St
          city:
            type: string
            example: Some City
          state:
            type: string
            example: NY
          postalCode:
            type: string
            example: 11101
          businessClassification:
            type: string
            example: 9ed3f670-7d6f-11e3-b1ce-5404a6144203
          businessName:
            type: string
            example: Jane Corp
          doingBusinessAs:
            type: string
            example: Jane's Electronics
          ein:
            type: string
            example: 00-0000000
          website:
            type: string
            example: https://www.domain.com
          controller:
            type: object
            required:
              - firstName
              - lastName
              - title
              - dateOfBirth
              - address
              - passport
            properties:
              firstName:
                type: string
                example: John
              lastName:
                type: string
                example: Controller
              title:
                type: string
                example: CEO
              dateOfBirth:
                type: string
                example: 1980-01-31
              address:
                type: object
                properties:
                  address1:
                    type: string
                  address2:
                    type: string
                  city:
                    type: string
                  stateProvinceRegion:
                    type: string
                  country:
                    type: string
                  postalCode:
                    type: string
              passport:
                type: object
                properties:
                  number:
                    type: string
                  country:
                    type: string
          businessType:
            type: string
            enum: [llc, corporation, partnership]
            example: llc

  # Fix micro-deposits endpoint name override
  - target: $["paths"]["/funding-sources/{id}/micro-deposits"]["get"]
    update:
      x-speakeasy-name-override: get

  # Remove the original micro-deposits POST endpoint. Micro-deposits operations have been moved to path fragments.
  - target: $["paths"]["/funding-sources/{id}/micro-deposits"]["post"]
    remove: true

  # Add path fragments for separate micro-deposits operations (Initiate and Verify)
  - target: $["paths"]
    update:
      "/funding-sources/{id}/micro-deposits#initiate":
        post:
          x-speakeasy-name-override: initiate
          tags:
            - funding sources
          summary: Initiate micro-deposits
          description: Initiates two small deposits to the customer's bank account for verification purposes. No request body is required.
          operationId: initiateMicroDeposits
          x-speakeasy-group: fundingSources.microDeposits
          parameters:
            - name: id
              in: path
              description: The ID of the funding source to initiate micro-deposits for
              required: true
              schema:
                type: string
            - name: Accept
              in: header
              required: true
              schema:
                type: string
                default: application/vnd.dwolla.v1.hal+json
          responses:
            '201':
              description: Micro-deposits initiated successfully
              headers:
                Location:
                  description: URL of the micro-deposits resource
                  schema:
                    type: string
                    example: "https://api-sandbox.dwolla.com/funding-sources/e52006c3-7560-4ff1-99d5-b0f3a6f4f909/micro-deposits"
            '403':
              description: Forbidden - funding source not eligible for micro-deposits
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: InvalidResourceState
                      message:
                        type: string
                        example: Bank already verified.
            '404':
              description: Funding source not found
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: NotFound
                      message:
                        type: string
                        example: The requested resource was not found.
      "/funding-sources/{id}/micro-deposits#verify":
        post:
          x-speakeasy-name-override: verify
          tags:
            - funding sources
          summary: Verify micro-deposits
          description: Verifies the micro-deposit amounts received in the customer's bank account to complete funding source verification.
          operationId: verifyMicroDeposits
          x-speakeasy-group: fundingSources.microDeposits
          parameters:
            - name: id
              in: path
              description: The ID of the funding source to verify micro-deposits for
              required: true
              schema:
                type: string
            - name: Accept
              in: header
              required: true
              schema:
                type: string
                default: application/vnd.dwolla.v1.hal+json
          requestBody:
            required: true
            description: The micro-deposit amounts received in the bank account
            content:
              application/vnd.dwolla.v1.hal+json:
                schema:
                  type: object
                  required:
                    - amount1
                    - amount2
                  properties:
                    amount1:
                      type: object
                      required:
                        - value
                        - currency
                      properties:
                        value:
                          type: string
                          example: 0.02
                        currency:
                          type: string
                          example: USD
                    amount2:
                      type: object
                      required:
                        - value
                        - currency
                      properties:
                        value:
                          type: string
                          example: 0.03
                        currency:
                          type: string
                          example: USD
          responses:
            '200':
              description: Micro-deposits verified successfully
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      _links:
                        type: object
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                                format: uri
                                example: 'https://api-sandbox.dwolla.com/funding-sources/2e446d1b-fb3c-42a0-9691-5d1d6a4dbbf0/micro-deposits'
                              type:
                                type: string
                                example: 'application/vnd.dwolla.v1.hal+json'
                              resource-type:
                                type: string
                                example: 'micro-deposits'
            '400':
              description: Bad Request - invalid deposit amounts
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: ValidationError
                      message:
                        type: string
                        example: Validation error(s) present. See embedded errors list for more details.
                      _embedded:
                        type: object
                        properties:
                          errors:
                            type: array
                            items:
                              type: object
                              properties:
                                code:
                                  type: string
                                  example: Invalid
                                message:
                                  type: string
                                  example: Wrong amount(s).
                                path:
                                  type: string
                                  example: ""
                                _links:
                                  type: object
            '403':
              description: Forbidden - verification not allowed in current state
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: InvalidResourceState
                      message:
                        type: string
                        example: Too many attempts.
            '404':
              description: Funding source not found
              headers: {}
              content:
                application/vnd.dwolla.v1.hal+json:
                  schema:
                    type: object
                    properties:
                      code:
                        type: string
                        example: NotFound
                      message:
                        type: string
                        example: The requested resource was not found.
